<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A Simple Crytocurrency App">
    <meta name="theme-color" content="#7c21f3" />
    <title>Bitcoinfo</title>

    <link rel="manifest" href="manifest.json">

    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="main.css" />
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
  </head>


<body class="text-indigo-900">

    <div class="loader bg-indigo-50">
        <img src="images/logo.svg"/>
    </div>
    <header class="bg-indigo-50 sticky top-0 w-full">
        <div class="container max-w-screen-xl mx-auto p-5">
            <!--   navbar -->
            <nav class="bg-white rounded-full px-8 py-5" role="navigation" aria-label="main navigation">
                <div class="flex justify-between content-center">
                    <div class="w-1/6">
                        <a class="navbar-item" href="#">
                        <img
                            src="images/logo.svg"
                        />
                        </a>
                    </div>
                    <div class="flex content-end font-bold">
                        <a class="navbar-item mr-6" href="#" target="_blank">
                            About the project
                        </a>
                    </div>
                </div>
            </nav>

            <!-- hero -->
            <div class="p-8">
            
                <div class="hero__content text-center mb-10 mt-4">
                    <span class="tag bg-cyan-500 rounded-full px-4 font-extrabold text-sm">price</span>
                    <h2 id="btcPrice" class="text-6xl font-bold my-2">$15,784,5 <span>usd</span></h2>
                    <h4 id="btcPriceArs" class="text-3xl "><span>ARS</span> $15,784,5423 </h4>
                </div>
                <div class="hero__cards flex justify-center content-center">
                    <div class="card bg-white rounded-2xl shadow-lg p-6 mr-5 text-red-500">
                        <p class="font-black">Lowest price today:</p>
                        <h5 id="lowPrice" class="text-3xl">$15,784,5 <span>usd</span></h5>
                    </div> 
                    <div class="card bg-white rounded-2xl shadow-lg p-6">
                        <p class="font-black">Highiest price today:</p>
                        <h5 id="highPrice" class="text-3xl">$15,784,5 <span>usd</span></h5>
                    </div>
                </div>

            </div>

        </div>
    </header>


    <section class="content_blog bg-white z-10 relative">
        <div class="arrow-btn"><img src="images/arrow-btn.svg" alt="arrow icon"></div>
        
        <div class="container max-w-screen-xl px-5 py-16 mx-auto">
            <div class="flex justify-between content-center">
            
            <h2 class="font-bold py-6 text-2xl">News</h2>
            <a class="navbar-item lang_es py-6" href="#" target="_blank">Spanish</a>
            </div>
            <div id="postContainer" class="flex flex-wrap -m-4 bg-white">
            </div>
        </div>
    </section>



    
<!--     <div class="modal">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box">
                <h2 class="title is-3">CryptoApp</h2>
                <p class="subtitle pb-5">created by <a href="https://www.linkedin.com/in/nicolasculotta/" target="_blank">Nicol√°s Culotta</a></p>
                <h3 class="title is-5">Dynamic Data from:</h3>
                <p class="subtitle pb-5"><a href="https://min-api.cryptocompare.com/">Cryptocompare API</a></p>
                <h3 class="title is-5">Technologies:</h3>
                <div class="tags">
                    <span class="tag is-danger">HTML & CSS</span>
                    <span class="tag is-primary">Bulma CSS</span>
                    <span class="tag is-info">Jquery</span>
                </div>
            </div>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div> -->

    <script>
        $(document).ready(function(){

            setInterval(() => {
                $('.loader').animate({
                    top: "-100%"
                }, 500)
            }, 2500); 

            //contentToggle
            $('.arrow-btn').click(function(){
                $('.content_blog').toggleClass('open');
                $('.card').toggleClass('show');
            })

            /* GETTING THE PRICES FROM API */
            $.ajax({
                url: "https://min-api.cryptocompare.com/data/pricemultifull?fsyms=BTC&tsyms=USD,ARS&api_key=8dd5a1a4a2e217c2bcff80ba9fc1fe114518aa7be79fff7a74877d46307532cd",
                success: function (data) {

                    const dataBTC = data.DISPLAY["BTC"]
                    //var boxTemplate = null;        
                    const arsPrice = dataBTC["ARS"].PRICE

                    const btcPriceObj = {
                        price: dataBTC["USD"].PRICE,
                        high: dataBTC["USD"].HIGHDAY,
                        low:  dataBTC["USD"].LOWDAY,
                    }

                    const btcPrice = $('#btcPrice').html(btcPriceObj.price + " " + "<span>usd</span>")
                    const btcPriceArs = $('#btcPriceArs').text(arsPrice)
                    const lowPrice = $('#lowPrice').html(btcPriceObj.low + " " + "<span>usd</span>")
                    const highPrice = $('#highPrice').html(btcPriceObj.high + " " + "<span>usd</span>")
                }
            }); 
            
            
            let language = "EN";

            const toggleLang = () => {
                if (language == "EN"){
                    language = "ES"
                    $('.lang_es').text('English')
                } else {
                    language = "EN"
                    $('.lang_es').text('Spanish')
                } 
            }

            $('.lang_es').on('click', function(e){
                toggleLang()
                loadPost()
                removePosts()  
                return false;
            });

            /* REMOVE ALL POST UNTIL NEW WILL COME */
            const removePosts = () => {
                const allPost = $('a[type="post"]');
                allPost.remove();
            }

            /* GETTING POSTS FROM API AND CREATE THE CARDS */
            const loadPost = () => {
                $.ajax({
                    url: "https://min-api.cryptocompare.com/data/v2/news/?lang="+language+"&categories=BTC&api_key=2854a5c3399c288c9183d204216c9c5d706e7d55bb64cd5a67eda10db684a574",
                    success: function (response) {
                        const dataNews = response.Data
                        const news = dataNews.slice(0,12)
                        const postContainer = $('#postContainer');

                        const createPost = (title, body, thumb, source, img, link ) => {

                            const post = `
                                <a type="post" href="${link}" class="p-4 md:w-1/3">
                                    <div class="h-full border border-indigo-200 rounded-card overflow-hidden card-hover">
                                        <img class="border-bottom-right-28 h-52  w-full object-cover object-center image-filter" src="${img}" alt="new">
                                        <div class="p-6 -mt-16">
                                            <img class="bg-white shadow mb-5 rounded-full h-20 w-20 object-cover object-center" src="${thumb}" alt="new">
                                            <h2 class="text-sm font-bold text-indigo-900 mb-1">${source}</h2>
                                            <h1 class="text-2xl font-bold text-indigo-900 mb-3">${title}</h1>
                                            <p class="leading-relaxed mb-6">${body}</p>
                                        </div>
                                    </div>
                                </a>
                            `;
                            return post;
                        }

                        news.forEach( (e) => {
                            const postData = {
                                title : e.title,
                                body : e.body,
                                thumb : e.source_info.img,
                                source: e.source,
                                img: e.imageurl,
                                link : e.url
                            }
                            postContainer.append(createPost(postData.title, postData.body, postData.thumb, postData.source, postData.img, postData.link))
                        })

                    
                    }
                });
            }

            loadPost();
        }) 

        
    </script>
  </body>
</html>
