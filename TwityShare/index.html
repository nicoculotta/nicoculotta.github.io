<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TwityShare</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="main.css" />
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script src="vendor/dom-to-img.min.js"></script>
  </head>


<body>
    <div class="app">
      <div id="printable">
            <template class="background-box">
              <div class="header-box">
                <div class="user-img">
                <img src="" alt="">
                </div>
                <div class="user-data">
                  <p class="username">Nicolas Culotta</p>
                  <p class="usertweet">@nicoculotta</p>
                </div>
              </div>
              <div class="user-text">I'm on another podcast episode! I don't enjoy listening to my own voice so you'll have to tell me what you think Cara sonriente con boca abierta y sudor fr√≠o Thanks for having me @andybaldacci</div>
          </template>
      </div>
      <button id="downloadBtn" class="">Download as JPG</button>
    </div>


    <script>
      let printable = document.getElementById('printable');
      let buttonDownload = document.getElementById('downloadBtn')

      // GET THE DATA FROM
      async function getTweet(){
        const response = await fetch('tweet.json');
        const tweet = await response.json()

        const { text, name, username, userimage } = tweet.data;
        printable.innerHTML = createTweet(text, name, username, userimage);
      }

      const createTweet = ( text, name, username, userimage ) => {
        return `
          <div class="background-box">
              <div class="header-box">
                <div class="user-img">
                   <img src="${userimage}" alt="">
                </div>
                <div class="user-data">
                  <p class="username">${name}</p>
                  <p class="usertweet">@${username}</p>
                </div>
              </div>
              <div class="user-text">${text}</div>
          </div>
        `
      }

      

      //DOM TO IMG
      let storySize = {
          quality: 0.95,
          width: 1080,
          height: 1920
      }

      let squareSize = {
          quality: 0.95,
          width: 500,
          height: 500
      }


      getTweet()

buttonDownload.addEventListener('click', function(){  
    domtoimage.toPng(printable, squareSize)
      .then(function (dataUrl) {
          let link = document.createElement('a');
          link.download = 'my-tweet.png';
          link.href = dataUrl;
          link.click();
      });
});

    </script>
  </body>
</html>
